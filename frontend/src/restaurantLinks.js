/**
 * Website and app store links by chain. Used for deal action modal.
 * Add more as needed; missing chains will still show Directions when coords exist.
 */
export const RESTAURANT_LINKS = {
  "McDonald's": {
    website: "https://www.mcdonalds.com/us/en-us.html",
    appStore: "https://apps.apple.com/app/mcdonalds/id922103212",
    playStore: "https://play.google.com/store/apps/details?id=com.mcdonalds.mobileapp",
  },
  "Taco Bell": {
    website: "https://www.tacobell.com",
    appStore: "https://apps.apple.com/app/taco-bell/id427824434",
    playStore: "https://play.google.com/store/apps/details?id=com.tacobell.ordering",
  },
  "Chipotle": {
    website: "https://www.chipotle.com",
    appStore: "https://apps.apple.com/app/chipotle/id297811961",
    playStore: "https://play.google.com/store/apps/details?id=com.chipotle.ordering",
  },
  "Wendy's": {
    website: "https://www.wendys.com",
    appStore: "https://apps.apple.com/app/wendys/id443860084",
    playStore: "https://play.google.com/store/apps/details?id=com.wendys",
  },
  "Burger King": {
    website: "https://www.bk.com",
    appStore: "https://apps.apple.com/app/burger-king/id428834295",
    playStore: "https://play.google.com/store/apps/details?id=com.bk.mobile",
  },
  "Chick-fil-A": {
    website: "https://www.chick-fil-a.com",
    appStore: "https://apps.apple.com/app/chick-fil-a/id593063532",
    playStore: "https://play.google.com/store/apps/details?id=com.chickfila.mobile",
  },
  "Panda Express": {
    website: "https://www.pandaexpress.com",
    appStore: "https://apps.apple.com/app/panda-express/id528582801",
    playStore: "https://play.google.com/store/apps/details?id=com.pandaexpress.ordering",
  },
  "Subway": {
    website: "https://www.subway.com",
    appStore: "https://apps.apple.com/app/subway/id327254683",
    playStore: "https://play.google.com/store/apps/details?id=com.subway.mobile",
  },
  "Domino's": {
    website: "https://www.dominos.com",
    appStore: "https://apps.apple.com/app/dominos-pizza/id321708914",
    playStore: "https://play.google.com/store/apps/details?id=com.dominos.us",
  },
  "Papa John's": {
    website: "https://www.papajohns.com",
    appStore: "https://apps.apple.com/app/papa-johns-pizza/id428827202",
    playStore: "https://play.google.com/store/apps/details?id=com.papajohns.android",
  },
  "Little Caesars": {
    website: "https://www.littlecaesars.com",
    appStore: "https://apps.apple.com/app/little-caesars/id415631954",
    playStore: "https://play.google.com/store/apps/details?id=com.littlecaesars.android",
  },
  "Pizza Hut": {
    website: "https://www.pizzahut.com",
    appStore: "https://apps.apple.com/app/pizza-hut/id428827202",
    playStore: "https://play.google.com/store/apps/details?id=com.yum.pizzahut",
  },
  "Olive Garden": {
    website: "https://www.olivegarden.com",
    appStore: "https://apps.apple.com/app/olive-garden/id428827202",
    playStore: "https://play.google.com/store/apps/details?id=com.darden.olivegarden",
  },
  "Buffalo Wild Wings": {
    website: "https://www.buffalowildwings.com",
    appStore: "https://apps.apple.com/app/buffalo-wild-wings/id428827202",
    playStore: "https://play.google.com/store/apps/details?id=com.buffalowildwings.consumer",
  },
  "Dunkin'": {
    website: "https://www.dunkindonuts.com",
    appStore: "https://apps.apple.com/app/dunkin/id317428673",
    playStore: "https://play.google.com/store/apps/details?id=com.dunkin.android",
  },
  "Starbucks": {
    website: "https://www.starbucks.com",
    appStore: "https://apps.apple.com/app/starbucks/id331177714",
    playStore: "https://play.google.com/store/apps/details?id=com.starbucks.mobilecard",
  },
  "Sonic": {
    website: "https://www.sonicdrivein.com",
    appStore: "https://apps.apple.com/app/sonic/id443752621",
    playStore: "https://play.google.com/store/apps/details?id=com.sonicdrivein.sonic",
  },
  "Arby's": {
    website: "https://www.arbys.com",
    appStore: "https://apps.apple.com/app/arbys/id428827202",
    playStore: "https://play.google.com/store/apps/details?id=com.arbys.arbys",
  },
  "Jack in the Box": {
    website: "https://www.jackinthebox.com",
    appStore: "https://apps.apple.com/app/jack-in-the-box/id428827202",
    playStore: "https://play.google.com/store/apps/details?id=com.jackinthebox.android",
  },
  "Whataburger": {
    website: "https://www.whataburger.com",
    appStore: "https://apps.apple.com/app/whataburger/id428827202",
    playStore: "https://play.google.com/store/apps/details?id=com.whataburger.android",
  },
  "Wingstop": {
    website: "https://www.wingstop.com",
    appStore: "https://apps.apple.com/app/wingstop/id428827202",
    playStore: "https://play.google.com/store/apps/details?id=com.wingstop.android",
  },
  "Raising Cane's": {
    website: "https://www.raisingcanes.com",
    appStore: "https://apps.apple.com/app/raising-canes/id428827202",
    playStore: "https://play.google.com/store/apps/details?id=com.raisingcanes.android",
  },
  "Zaxby's": {
    website: "https://www.zaxbys.com",
    appStore: "https://apps.apple.com/app/zaxbys/id428827202",
    playStore: "https://play.google.com/store/apps/details?id=com.zaxbys.android",
  },
  "Popeyes": {
    website: "https://www.popeyes.com",
    appStore: "https://apps.apple.com/app/popeyes/id428827202",
    playStore: "https://play.google.com/store/apps/details?id=com.popeyes.android",
  },
  "KFC": {
    website: "https://www.kfc.com",
    appStore: "https://apps.apple.com/app/kfc/id428827202",
    playStore: "https://play.google.com/store/apps/details?id=com.yum.kfc",
  },
  "Panera Bread": {
    website: "https://www.panerabread.com",
    appStore: "https://apps.apple.com/app/panera-bread/id428827202",
    playStore: "https://play.google.com/store/apps/details?id=com.panera.bread",
  },
  "Jimmy John's": {
    website: "https://www.jimmyjohns.com",
    appStore: "https://apps.apple.com/app/jimmy-johns/id428827202",
    playStore: "https://play.google.com/store/apps/details?id=com.jimmyjohns.android",
  },
  "Qdoba": {
    website: "https://www.qdoba.com",
    appStore: "https://apps.apple.com/app/qdoba/id428827202",
    playStore: "https://play.google.com/store/apps/details?id=com.qdoba.android",
  },
  "IHOP": {
    website: "https://www.ihop.com",
    appStore: "https://apps.apple.com/app/ihop/id428827202",
    playStore: "https://play.google.com/store/apps/details?id=com.ihop.android",
  },
  "Denny's": {
    website: "https://www.dennys.com",
    appStore: "https://apps.apple.com/app/dennys/id428827202",
    playStore: "https://play.google.com/store/apps/details?id=com.dennys.android",
  },
  "Applebee's": {
    website: "https://www.applebees.com",
    appStore: "https://apps.apple.com/app/applebees/id428827202",
    playStore: "https://play.google.com/store/apps/details?id=com.applebees.android",
  },
  "Chili's": {
    website: "https://www.chilis.com",
    appStore: "https://apps.apple.com/app/chilis/id428827202",
    playStore: "https://play.google.com/store/apps/details?id=com.chilis.android",
  },
  "Texas Roadhouse": {
    website: "https://www.texasroadhouse.com",
    appStore: "https://apps.apple.com/app/texas-roadhouse/id428827202",
    playStore: "https://play.google.com/store/apps/details?id=com.texasroadhouse.android",
  },
  "Dairy Queen": {
    website: "https://www.dairyqueen.com",
    appStore: "https://apps.apple.com/app/dairy-queen/id428827202",
    playStore: "https://play.google.com/store/apps/details?id=com.dairyqueen.android",
  },
  "Krispy Kreme": {
    website: "https://www.krispykreme.com",
    appStore: "https://apps.apple.com/app/krispy-kreme/id428827202",
    playStore: "https://play.google.com/store/apps/details?id=com.krispykreme.android",
  },
  "Red Lobster": {
    website: "https://www.redlobster.com",
    appStore: "https://apps.apple.com/app/red-lobster/id428827202",
    playStore: "https://play.google.com/store/apps/details?id=com.redlobster.android",
  },
  "P.F. Chang's": {
    website: "https://www.pfchangs.com",
    appStore: "https://apps.apple.com/app/p-f-changs/id428827202",
    playStore: "https://play.google.com/store/apps/details?id=com.pfchangs.android",
  },
};

/**
 * Resolve brand domain from restaurant name (for logo URLs).
 */
function getBrandDomain(restaurantName) {
  if (!restaurantName) return "restaurant.com";
  const links = RESTAURANT_LINKS[restaurantName];
  let domain = null;
  if (links?.website) {
    try {
      domain = new URL(links.website).hostname.replace(/^www\./, "");
    } catch (_) {}
  }
  if (!domain) {
    const slug = restaurantName.toLowerCase().replace(/[^a-z0-9]/g, "");
    domain = slug ? slug + ".com" : "restaurant.com";
  }
  return domain;
}

/** Clearbit logo API – high-res logos; returns 404 for unknown domains. */
const CLEARBIT_LOGO_BASE = "https://logo.clearbit.com/";

/** Google favicon – reliable fallback when Clearbit has no logo. */
const FAVICON_BASE = "https://www.google.com/s2/favicons?sz=128&domain=";

/**
 * Returns [primaryUrl, fallbackUrl] for brand logo. Try primary (Clearbit) first;
 * on 404/error use fallback (Google favicon) so logos stay sharp when available.
 */
export function getBrandLogoUrls(restaurantName) {
  const domain = getBrandDomain(restaurantName);
  const primary = CLEARBIT_LOGO_BASE + encodeURIComponent(domain);
  const fallback = FAVICON_BASE + encodeURIComponent(domain);
  return [primary, fallback];
}

/**
 * Single URL for backward compatibility (returns Clearbit first; use getBrandLogoUrls for fallback chain).
 */
export function getBrandLogoUrl(restaurantName) {
  const [primary] = getBrandLogoUrls(restaurantName);
  return primary;
}
